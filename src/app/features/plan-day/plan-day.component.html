<ng-container
  *ngrxLet="{ date: date$, workouts: workouts$, settings: settings$ } as vm"
>
  <ion-content class="ion-padding" fullscreen>
    <header class="flex flex-col items-center gap-4 py-8 relative">
      <ion-thumbnail class="w-20 h-20 rounded-full">
        <fa-icon class="text-primary text-3xl" icon="calendar-day"></fa-icon>
      </ion-thumbnail>
      <h5 class="font-bold">{{ vm.date | date }}</h5>
    </header>
    <ion-list class="rounded-3xl" lines="none">
      <ng-container *ngIf="events.controls.length">
        <ng-container *ngFor="let control of events.controls">
          <ion-item *ngIf="control.value.workout">
            <ion-thumbnail class="w-14 h-14 rounded-full">
              <fa-icon class="text-primary text-lg" icon="bell"></fa-icon>
            </ion-thumbnail>
            <ion-label class="px-4">
              {{ control.value.workout.label }}
            </ion-label>
          </ion-item>
        </ng-container>
      </ng-container>
      <ion-item button id="workout">
        <ion-thumbnail class="w-14 h-14 rounded-full">
          <fa-icon class="text-warning text-lg" icon="add"></fa-icon>
        </ion-thumbnail>
        <ion-label class="px-4">Add Workout</ion-label>
      </ion-item>
    </ion-list>
    <ion-grid>
      <ion-row>
        <ion-col>
          <ion-button fill="clear" expand="full" (click)="onCancel()">
            <span class="text-danger">Cancel</span>
          </ion-button>
        </ion-col>
        <ion-col>
          <ion-button fill="clear" expand="full" (click)="onSave()">
            <span class="text-primary">Save</span>
          </ion-button>
        </ion-col>
      </ion-row>
    </ion-grid>
  </ion-content>

  <ion-modal
    #modal
    trigger="workout"
    [initialBreakpoint]="0.65"
    [breakpoints]="[0, 0.25, 0.45, 0.65]"
  >
    <ng-template>
      <ion-content>
        <ion-list class="h-full" lines="none">
          <ion-list-header class="bg-step50">
            <ion-label class="text-center text-lg font-bold py-2">
              Choose Workout
            </ion-label>
          </ion-list-header>
          <ng-container *ngFor="let item of vm.workouts">
            <ion-item button (click)="onAddWorkout(item, vm.date, vm.settings)">
              <ion-thumbnail class="rounded-full my-2" slot="start">
                <fa-icon class="text-primary" [icon]="item.icon"></fa-icon>
              </ion-thumbnail>
              <ion-label class="px-4">
                <div class="mb-1">{{ item.label }}</div>
                <div class="flex items-center gap-4 text-xs">
                  <div class="flex items-center gap-1">
                    <fa-icon class="text-primary" icon="heart"></fa-icon>
                    <span class="text-medium">
                      {{ item.intensity }} pts/min
                    </span>
                  </div>
                  <div class="flex items-center gap-1">
                    <fa-icon class="text-primary" icon="fire"></fa-icon>
                    <span class="text-medium"> {{ item.energy }} cal/min </span>
                  </div>
                </div>
              </ion-label>
            </ion-item>
          </ng-container>
        </ion-list>
      </ion-content>
    </ng-template>
  </ion-modal>
</ng-container>
